@model List<CVHub.Models.Account>
@{
    ViewData["Title"] = "Main";
}
<link rel="stylesheet" href="~/css/main.css" asp-append-version="true" />

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CVHub - Find Developers</title>
</head>
<body>
    
    <div class="page">
        <div class="prt-1">
            <div class="main">
                <p class="logo">
                    CVHub
                </p>
                <img src="/images/comp.png" alt="comp">
            </div>
            
            <div class="options">
                <select class="dropdown" id="ageFilter">
                    <option value="" disabled selected>Age</option>
                    <option value="16-18">16-18</option>
                    <option value="18-30">18-30</option>
                    <option value="30-50">30-50</option>
                    <option value="50+">50+</option>
                </select>

                <select class="dropdown" id="roleFilter">
                    <option value="" disabled selected>All Roles</option>
                    <option value="Frontend Developer">Frontend Developer</option>
                    <option value="Backend Developer">Backend Developer</option>
                    <option value="Fullstack Developer">Fullstack Developer</option>
                    <option value="Mobile Developer">Mobile Developer</option>
                    <option value="Game Developer">Game Developer</option>
                    <option value="Automation QA">Automation QA</option>
                </select>

                <select class="dropdown" id="seniorityFilter">
                    <option value="" disabled selected>All Levels</option>
                    <option value="Junior">Junior</option>
                    <option value="Middle">Middle</option>
                    <option value="Senior">Senior</option>
                </select>

                
                <button id="resetFilters" class="btn">Reset filters</button>
            </div>
        </div>

        <div class="cards">
            @if (Model != null && Model.Any())
            {
                foreach (var account in Model)
                {
                    <div class="card" 
                         data-age="@account.Age"
                         data-role="@account.Role" 
                         data-seniority="@account.Seniority"
                         onclick="window.location.href='@Url.Action("ViewResume", "Home", new { id = account.Id })'" 
                         style="cursor: pointer;">
                         
                        <div class="avatar">
                            <img src="@(string.IsNullOrEmpty(account.Photo) ? "/images/avatar.png" : account.Photo)" 
                                 alt="avatar" style="width: 130px; height: 150px">
                        </div>
                        <div class="part">
                            <div class="about">
                                <div class="name">
                                    <p>@account.Name</p>
                                    <p>@account.Surname</p>
                                </div>
                            </div>
                            <div>
                                @if (!string.IsNullOrEmpty(account.Role))
                                {
                                    <p class="work">@account.Role</p>
                                    <p>@account.Age</p>
                                }
                                <div class="languages">
                                    @foreach (var skill in account.GetSkillsList())
                                    {
                                        <div class="language">
                                            <p>@skill</p>
                                        </div>
                                    }
                                    @if (account.GetSkillsList().Count > 5)
                                    {
                                        <div class="language">
                                            <p>+@(account.GetSkillsList().Count - 5)</p>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                }
            }
            else
            {
                <div class="no-profiles">
                    <h3>No profiles found</h3>
                </div>
            }
        </div>
    </div>

<script>
document.addEventListener("DOMContentLoaded", function () {
    console.log("bebeb");
    const ageFilter = document.getElementById("ageFilter");
    const roleFilter = document.getElementById("roleFilter");
    const seniorityFilter = document.getElementById("seniorityFilter");
    const resetBtn = document.getElementById("resetFilters");
    const cards = document.querySelectorAll(".card");

    function applyFilters() {
        const ageValue = ageFilter.value;
        const roleValue = roleFilter.value;
        const seniorityValue = seniorityFilter.value;

        cards.forEach(card => {
            let show = true;

            const age = parseInt(card.dataset.age || "0");
            const role = card.dataset.role || "";
            const seniority = card.dataset.seniority || "";

            // фильтр по возрасту
            if (ageValue) {
                switch (ageValue) {
                    case "16-18":
                        if (age < 16 || age > 18) show = false;
                        break;
                    case "18-30":
                        if (age < 18 || age > 30) show = false;
                        break;
                    case "30-50":
                        if (age < 30 || age > 50) show = false;
                        break;
                    case "50+":
                        if (age < 50) show = false;
                        break;
                }
            }

            // фильтр по роли
            if (roleValue && role !== roleValue) {
                show = false;
            }

            // фильтр по уровню
            if (seniorityValue && seniority !== seniorityValue) {
                show = false;
            }

            card.style.display = show ? "flex" : "none";
        });
    }

    // обработчики
    ageFilter.addEventListener("change", applyFilters);
    roleFilter.addEventListener("change", applyFilters);
    seniorityFilter.addEventListener("change", applyFilters);

    // сброс фильтров
    resetBtn.addEventListener("click", function () {
        ageFilter.selectedIndex = 0;
        roleFilter.selectedIndex = 0;
        seniorityFilter.selectedIndex = 0;

        // показать все карточки
        cards.forEach(card => card.style.display = "flex");
    });
});
</script>
</body>
</html>
